<!DOCTYPE html>
<html lang="pl">
  <head>
    <title>Panel - MapRER</title>
    <link rel="icon" href="img/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/dashboard/style.css">
      <style>
        body {
          background-image: url('img/Projekt bez nazwy.png'); /* Podaj ścieżkę do swojego obrazu */
          background-size: cover; /* Dopasowuje obraz do rozmiaru okna przeglądarki */
          background-attachment: fixed; /* Zamraża tło, gdy użytkownik przewija stronę */
        }
      </style>
    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
    <!-- Below is the additional script for Firebase Auth -->
    <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-auth.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyAwx633a5SDLjAAW9S-cjP6y-VTpLQt-50",
        authDomain: "maprer-a4dde.firebaseapp.com",
        projectId: "maprer-a4dde",
        storageBucket: "maprer-a4dde.appspot.com",
        messagingSenderId: "934202492753",
        appId: "1:934202492753:web:9fb85d64685be379143570",
        measurementId: "G-XCRP6N2EXS"
      };
      firebase.initializeApp(firebaseConfig);

      const auth = firebase.auth();
    </script>
    <script src="/dashboard/script.js"></script>
  </head>
  <body>
    <button id="logout">
        Log out
    </button>
    <div>
      <div class="centered-text">
        <p>
          <small class="small-text">
            Witaj w
          </small>
          <br>
          <strong class="big-text">
            MapRER
          </strong>
        </p>
      </div>
    </div>
    <form id="user-data-form">
      <label for="country">Kraj:</label>
      <input type="text" id="country" name="country" required><br>

      <label for="money">Pieniądze:</label>
      <input type="number" id="money" name="money" required><br>

      <label for="rank">Ranga:</label>
      <input type="text" id="rank" name="rank" required><br>

      <button type="submit">Zapisz</button>
    </form>

    <!-- Miejsce na wyświetlenie danych użytkownika -->
    <div id="user-info">
      <h2>Dane Użytkownika</h2>
      <p><strong>Kraj:</strong> <span id="display-country"></span></p>
      <p><strong>Pieniądze:</strong> <span id="display-money"></span></p>
      <p><strong>Ranga:</strong> <span id="display-rank"></span></p>
    </div>

    <script>
      // Pobierz obecnie zalogowanego użytkownika z Firebase Authentication
      const user = firebase.auth().currentUser;

      // Adres e-mail użytkownika, który ma mieć dostęp
      const authorizedUserEmail = "adamograczyk@gmail.com";

      if (user && user.email === authorizedUserEmail) {
        // Wyświetl formularz tylko dla użytkownika "adam.graczyk@maprer.glitch.me"
        document.getElementById("user-data-form").style.display = "block";
      } else {
        // Ukryj formularz dla innych użytkowników
        document.getElementById("user-data-form").style.display = "none";
      }

      // Nasłuchuj zdarzenie przesłania formularza
      document.getElementById("user-data-form").addEventListener("submit", function(event) {
        event.preventDefault(); // Zatrzymaj domyślne działanie formularza

        // Pobierz dane z formularza
        const country = document.getElementById("country").value;
        const money = document.getElementById("money").value;
        const rank = document.getElementById("rank").value;

        // Pobierz UID z uwierzytelniania Firebase
        const userUID = firebase.auth().currentUser.uid;

        // Ustaw dane użytkownika w bazie danych Firebase Realtime Database
        const userData = {
          kraj: country,
          pieniadze: money,
          ranga: rank
        };

        // Zapisz dane użytkownika w bazie danych
        firebase.database().ref(`users/${userUID}`).set(userData)
          .then(function() {
            // Aktualizuj wyświetlane dane na stronie
            document.getElementById("display-country").textContent = country;
            document.getElementById("display-money").textContent = money;
            document.getElementById("display-rank").textContent = rank;
            alert("Dane zostały zaktualizowane.");
          })
          .catch(function(error) {
            console.error("Wystąpił błąd podczas zapisywania danych: ", error);
          });
      });
    </script>
    <script src="/dashboard/script.js"></script>
  </body>
</html>
